% Mettre un "%" devant le style à ne pas utiliser
\documentclass{refig} % style de la revue REFIG
%\documentclass{afig} % style des journées AFIG

\usepackage[latin1]{inputenc} 
\usepackage[frenchb]{babel} 
\usepackage{t1enc,dfadobe}
\usepackage{cite}
\usepackage[toc, page]{appendix}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{amssymb}

% for including postscript figures
% mind: package option 'draft' will replace PS figure by a filename within a frame
\ifpdf \usepackage[pdftex]{graphicx} \pdfcompresslevel=9
\else \usepackage[dvips]{graphicx} \fi


\title[Article REFIG]{Article REFIG (titre long)}

\author[Julien Bosman]{Julien Bosman \\ LIFL/INRIA}

\begin{document}

\maketitle

\begin{abstract}
   Ceci est un résumé. Un résumé en anglais et en français est demandé.

\end{abstract}
\keywords{Simulation, Méthodes sans maillage, Mécanique}
%-------------------------------------------------------------------------
\section{Introduction}

Le style de la revue REFIG\cite{REFIG1} utilisé est un style adapté de celui d'Eurographics.

\section{Etat de l'art}

La simulation à base de méthodes sans maillage à été introduite en informatique graphique avec \cite{Desbrun1996} et l'utilisation des
\emph{Smoothed Particle Hydrodynamics} (SPH) -- reposant sur l'interaction réciproque d'un ensemble de particules -- pour l'animation de modèles
très déformables. Les SPH demeurent une méthodes populaires pour l'animation de fluides et d'objets déformables. Les travaux de \cite{Becker2009} apportent une
réponse au problème des non-linéarités géométrique en proposant un modèle corotationnel dédié. La méthode des SPH permet également de simuler des matériaux
non-newtoniens aux comportements plus complexes \cite{Paiva2009}. Parallèlement, d'autres méthodes d'animation sans maillage ont été développées. Des modèles
basés sur la mécanique des milieux continus à l'instar de \cite{Keiser2004} et de \cite{Horton2010} où les champs de déplacement sont approximés grâce aux
\emph{Moving} Least Squares (MLS). Des techniques d'animation, non basées sur la physique,ont également été développées. Dans \cite{Muller2005}, les objets sont
déformés grâce à un système masse ressort en utilisant la méthode dite de \emph{Shape Matching}, où les points de l'objet sont partitionnés en plusieurs groupes
dont on estime une rotation optimale et une translation par rapport à la configuration non déformée. Cette idée est reprise dans \cite{Muller2011} à la
différence près que chaque possède une orientation qui est estimée au grâce à un \emph{Shape Matching} généralisé.

\section{Simulation}

\subsection{Cinématique}
Les objets déformables sont discrétisés par un ensemble de n{\oe}uds et de points d'intégration. Les n{\oe}uds sont des repères à six degrés de liberté (DDL) :
\begin{equation}
\mathbf{q}_i = \left[ x_1 \ x_2 \ x_3 \ r_1 \ r_2 \ r_3 \right]^t = \left[ \mathbf{x}_i \ {\mathbf{r}_i} \right]^t
\end{equation}

Les points d'intégration ne possèdent que trois DDL. Dans la mesure où l'on utilise une formulation en lagragien total, la position
globale des points d'intégration est exprimée en fonction de leur position dans chacun des repères dans la configuration non déformée. Les coordonnées
d'un point d'intégration $s$ dans le repère $i$ dans la configuration non déformée est donné par :
\begin{equation}
	\bar{\mathbf{p}}_s^{l,i} = {[\mathbf{R}}_i^0]^t \times \left( \bar{\mathbf{p}}_s - \bar{\mathbf{x}}_i\right)
\end{equation}
où $\mathbf{R}_i^0$ et $\bar{\mathbf{x}}_i$ sont la matrice de rotation et les coordonnées du repère $i$ et $\bar{\mathbf{p}}_s$ les coordonnées du point
d'intégration $s$ dans la configuration non déformée. Ainsi, les coordonnées du point d'intégration $s$ dans la configuration déformée sont donnés par :
\begin{equation}
	\mathbf{p}_s = \sum_{i} w_s(\mathbf{x}_i)\left(\mathbf{x}_i + [\mathbf{R}_i] \times \bar{\mathbf{p}}_s^{l,i} \right)
	\label{eq:sample_pos}
\end{equation}
où $w_s(\cdot)$ est une fonction de forme associée au point d'intégration $s$ et $q_i$ et $\mathbf{R}_i$ les coordonnées et la rotation du repère $i$ dans la
configuration déformée.

De la même façon, la cinématique des repères est influencée par le mouvement des points d'intégration qui lui sont associés. L'orientation du repère $i$ dans
la configuration déformée et donnée par :
\begin{equation}
	\mathbf{r}_i = \sum_{s}{w_s(\mathbf{x}_i)\left( \mathbf{\bar{p}}_s^{l,i} \wedge \mathbf{u}_s^{l,i} \right)}
\end{equation}
où $\mathbf{u}_s^{l,i} = \mathbf{p}_s^{l,i} - \mathbf{\bar{p}}_s^{l,i} $ est le déplacement subi par le point d'intégration $s$ localement au repère $i$.

\subsection{Dynamique}
\subsubsection{Expression des forces internes}
La méthode décrite dans cet article utilise une formulation en lagrangien total. Dans une formulation en lagrangien total les déplacements sont évalués par
rapport à la configuration non déformée de l'objet contrairement à la formulation en lagragien updatée où ils sont évalués par rapport à la
configuration de l'objet au pas de temps précédent.
Le calcul des forces internes fait appel au principe des \emph{travaux virtuels} :
\begin{equation}
	\delta W = \delta q \cdot f = \int_{\Omega}{ \frac{\partial L{^t}}{\partial q} \{S\}d\Omega }
	\label{eq:virtual_work}
\end{equation}
où $L = \frac{1}{2}(F^t F - I)$ est le tenseur de déformation de \emph{Green-Lagrange} où $F$ est le gradient de déformation. $S$ le second tenseur de
contrainte de \emph{Piola-Kirchoff}. L'expression de la dérivée du tenseur de Green-Lagrange par rapport au degrés de liberté des repères est donné par :
\begin{equation}
	\frac{\partial L}{\partial q} = \frac{1}{2}\left(\frac{\partial F^t}{\partial q} F + F^t \frac{\partial F}{\partial q} \right)
	\label{eq:green_lagrange_der}
\end{equation}

L'équation (\ref{eq:sample_pos}) permet de calculer le tenseur de déformation en un point d'intégration $s$:
\begin{equation}
	F_s = \frac{\partial \mathbf{p}_s}{\partial \mathbf{X}} = \sum_{i}{\left[ \frac{\partial w_s(\mathbf{x}_i)}{\partial X} \left(\mathbf{x}_i + [\mathbf{R}_i] 
\bar{\mathbf{p}}_s^{l,i} \right) + w_s(\mathbf{x}_i)[\mathbf{R}_i] [\mathbf{R}_i^0]^t \right] } 
%& = \sum_{i}{\left[ \nabla w_s(\mathbf{x}_i) \left(\mathbf{x}_i + \mathbf{R}_i \times \bar{\mathbf{p}}_s^{l,i} \right) + w_s(\mathbf{x}_i)\mathbf{R}_i
%\mathbf{R}_i^{0t} \right] }
\end{equation}
Afin d'obtenir la dérivée du tenseur de \emph{Green-Lagrange} de l'équation (\ref{eq:green_lagrange_der}) il est nécessaire de calculer la dérivée du tenseur de
déformation :
\begin{equation}
\begin{split}
	\delta F_{IJ}^{s} =& \sum_{i}{\left(\delta \mathbf{x}_i + [-\mathbf{R}_{i}(\mathbf{\bar{p}}_s^{l,i})^{\text{\tiny{$\wedge$}}}]^{I,}\cdot \delta
\mathbf{r}_i\right) \frac{\partial w_s(\mathbf{x}_i)}{\mathbf{X}_j}} \ + \\
& [-\mathbf{R}_{i}(r^0_{,J})^{\text{\tiny{$\wedge$}}}]^{I,} \cdot \delta \mathbf{r_i} w_s(\mathbf{x}_i)
\end{split}
\label{eq:def_grad_der}
\end{equation}
avec $\mathbf{R}_{i}(\mathbf{\bar{p}}_s^{l,i})$ la rotation de $\mathbf{\bar{p}}_s^{l,i}$ par $\mathbf{R}_i$, $[\mathbf{v}^{\text{\tiny{$\wedge$}}}]$la
matrice antisymétrique $3\times 3$ associée au produit vectoriel, $[\mathbf{M}]^{i,}$ et $[\mathbf{M}]^{,j}$ correspondent respectivement à la $i^{\text{ème}}$
ligne et à la
$j^{\text{ème}}$ colonne de la matrice $\mathbf{M}$ et $r^0_{,J} = [\mathbf{R}_i^0]^{J,}$.
En réécrivant les 9 valeurs de $\delta F^{s}$ sous forme d'un vecteur colonne, l'équation (\ref{eq:def_grad_der}) peut être exprimée sous la forme d'un produit
matrice-vecteur :
\begin{equation}
	\left[
	\begin{array}{c}
		\delta F_{xx}^s \\
		\delta F_{xy}^s \\
		\vdots \\
		\delta F_{zz}^s
	\end{array}
	\right] = \sum_{i}{\mathbf{B}^{i,s} \cdot \delta \mathbf{q}_i}
	\label{eq:delta_F}
\end{equation}
avec $\delta \mathbf{q}_i^t = [\delta \mathbf{x}_i \ \delta \mathbf{r}_i]^t$. La matrice $B$ est donnée en annexe. De la même façon, il est également possible
d'écrire $\partial L / \partial q$ sous la forme d'un produit matrice-vecteur. En effet :
\begin{equation}
\begin{split}
	\delta L_{xy} &= \frac{1}{2}\left([\delta F^t]^{1,}\cdot[F]^{,2} + [F^t]^{1,}\cdot[\delta F]^{,2}\right) \\
	&= \frac{1}{2}\left([\delta F_{xx} \ \delta F_{yx} \ \delta F_{zx}]\cdot[F]^{,2} + [F^t]^{1,}\cdot[\delta F_{xy} \ \delta F_{yy} \ \delta F_{zy}]\right)
\end{split}
\end{equation}
Or, d'après l'équation (\ref{eq:delta_F}) :
\begin{equation}
	[\delta F_{xx} \ \delta F_{yx} \ \delta F_{zx}] = [B_{1,}\cdot \delta q \ B_{3,}\cdot \delta q \  B_{7,}\cdot \delta q]
\end{equation}
avec $B_{i,}$ la $i^{\text{ème}}$ ligne de la matrice $B$ d'où :
\begin{equation}
	\delta L_{xy} = \frac{1}{2}\left[F_{xy}B_{1,} +  F_{yy}B_{4,} + F_{zy}B_{7,} + F_{xx}B_{2,} + F_{yx}B_{5,} + F_{zx}B_{8,} \right] \cdot \delta q
\end{equation}
On a donc : 
\begin{equation}
	\left[
	\begin{array}{c}
		\delta L_{xx}^s \\
		\delta L_{xy}^s \\
		\vdots \\
		\delta L_{zz}^s
	\end{array}
	\right] = \sum_{i}{\mathbf{M}^{i;s} \cdot \delta \mathbf{q}_i}
	\label{eq:delta_L}	
\end{equation}
En substituant l'équation (\ref{eq:delta_L}) à l'équation (\ref{eq:virtual_work}) et en divisant par $\delta q$ on obtient :
\begin{equation}
	f = \int_{\Omega}{\mathbf{M}^t\{\mathbf{S}\}}d\Omega
\end{equation}
ou, en version discrète : 
\begin{equation}
	f_i = \sum_{s}{\mathbf{M}^{i,s}\{\mathbf{S}^s\}w_s(\mathbf{x}_i)}
	\label{eq:force_discrete}
\end{equation}
avec $S$ calculé grâce à la \emph{loi de Hooke}:
\begin{equation}
	\mathbf{S} = \lambda \ tr(\mathbf{L})\mathbf{I} + 2 \mu \mathbf{L}
\end{equation}
en notation de Voigt où $\lambda$ et $\mu$ sont les \emph{coefficients de Lamé}

\subsubsection{Formulation implicite}
La formulation précédente (équation \ref{eq:force_discrete}) est utilisable avec un solveur explicite. Cependant, bien qu'ils soient rapides, les solveurs
explicites présentent certains désavantages, notamment l'instabilité. Les oscillations et l'introduction d'énergie supplémentaire conduisent la simulation à
``exploser''. Un solution courament employée pour répondre à ce problème consiste à utiliser des pas de temps très court avec pour effet de ralentir la
simulation.
Pour ces raisons, on utilise un solveur implicte qui est inconditionnellement stable -- une proprièté intéressante dans le cadre de la simulation
d'objets déformables. Les solveurs implicites permettent de résoudre un problème non-linéaire de manière itérative selon la méthode de \emph{Newton-Raphson}
\cite{faure:hal-00681539}. Pour permettre au solveur de résoudre l'équation du mouvement, il est nécessaire de linéariser la force, c'est-à-dire dériver
l'expression de la force par rapport aux repères. D'après \cite{NFECS} on a :
\begin{equation}
	\delta f = \int_{\Omega}{\mathbf{M^t}\{\delta \mathbf{S}\}d\Omega}
	\label{eq:force_der}
\end{equation}
avec :
\begin{equation}
	\{\delta \mathbf{S}\} = \mathbf{C}\{\delta \mathbf{L}\}
\end{equation}
ou la matrice $\mathbf{C}$ donnée en annexe est la matrice des coefficients elastiques associés à la loi de Hooke. En substituant l'équation (\ref{eq:delta_L})
à l'équation (\ref{eq:force_der}) on obtient :
\begin{equation}
	\delta f = \int_{\Omega}{\mathbf{M^t}\mathbf{C}\mathbf{M}} \cdot \delta q
\end{equation}


\subsection{Figures en couleur} Etant donné qu'il s'agit d'une publication électronique, il n'y a aucune censure à avoir sur les figures en couleur (cf figure \ref{fig:ex3}. 


\begin{figure*}[htb]
  \centering
  \mbox{} \hfill
  \includegraphics[width=.3\linewidth]{logoafig}
  \hfill
  \includegraphics[width=.3\linewidth]{logoafig}
  \hfill \mbox{}
  \caption{\label{fig:ex3}
           Les figures en couleurs ou en noir et blanc peuvent être placées n'importe ou dans le document. }
\end{figure*}

\subsection{Tableau}

\begin{table}[h]
\begin{tabular}{|l|c|r|}
\hline
Laboratoire & Ville & Année\\ \hline
LABRI & Bordeaux & 2006 \cite{AFIG06}\\ \hline
LSIIT & Strasbourg & 2005 \cite{AFIG05} \\ \hline
\end{tabular}
\label{tab:tab1}
\caption{Exemple de tableau des dernières journées de l'AFIG.}
\end{table}



\section{Conclusion}
Cette conclusion fait le bilan des apports de ce travail à la communauté.

%-------------------------------------------------------------------------
\newpage

\bibliographystyle{refig-alpha}
\bibliography{biblio}

%-------------------------------------------------------------------------


\newpage
\renewcommand\arraystretch{2}
\begin{appendices}
\section{Calcul de la matrice $B$}
\end{appendices}
\begin{equation*}
\begin{split}
	& \mathbf{B}^{i,s} = \\
	&
	\left[\begin{array}{cccc}
		\frac{\partial w_{is}}{\partial x} & 0 & 0 & \left[\frac{\partial w_{is}}{\partial x}
		[-\mathbf{R}_{i}(\mathbf{\bar{p}}_s^{l,i})^{\text{\tiny{$\wedge$}}}]^{x,} + [-\mathbf{R}_{i}(r^0_{,x})^{\text{\tiny{$\wedge$}}}]^{x,}\ w_{is}
		\right]\\
		\frac{\partial w_{is}}{\partial y} & 0 & 0 & \left[\frac{\partial w_{is}}{\partial y}
		[-\mathbf{R}_{i}(\mathbf{\bar{p}}_s^{l,i})^{\text{\tiny{$\wedge$}}}]^{x,} + [-\mathbf{R}_{i}(r^0_{,y})^{\text{\tiny{$\wedge$}}}]^{x,}\ w_{is}
		\right] \\
		\frac{\partial w_{is}}{\partial z} & 0 & 0 & \left[\frac{\partial w_{is}}{\partial z}
		[-\mathbf{R}_{i}(\mathbf{\bar{p}}_s^{l,i})^{\text{\tiny{$\wedge$}}}]^{x,} + [-\mathbf{R}_{i}(r^0_{,z})^{\text{\tiny{$\wedge$}}}]^{x,}\ w_{is}
		\right]\\		
		0 & \frac{\partial w_{is}}{\partial x} & 0 & \left[\frac{\partial w_{is}}{\partial x}
		[-\mathbf{R}_{i}(\mathbf{\bar{p}}_s^{l,i})^{\text{\tiny{$\wedge$}}}]^{y,} + [-\mathbf{R}_{i}(r^0_{,x})^{\text{\tiny{$\wedge$}}}]^{y,}\ w_{is}
		\right]\\
		0 & \frac{\partial w_{is}}{\partial y} & 0 & \left[\frac{\partial w_{is}}{\partial y}
		[-\mathbf{R}_{i}(\mathbf{\bar{p}}_s^{l,i})^{\text{\tiny{$\wedge$}}}]^{y,} + [-\mathbf{R}_{i}(r^0_{,y})^{\text{\tiny{$\wedge$}}}]^{y,}\ w_{is}
		\right] \\
		0 & \frac{\partial w_{is}}{\partial z} & 0 & \left[\frac{\partial w_{is}}{\partial z}
		[-\mathbf{R}_{i}(\mathbf{\bar{p}}_s^{l,i})^{\text{\tiny{$\wedge$}}}]^{y,} + [-\mathbf{R}_{i}(r^0_{,z})^{\text{\tiny{$\wedge$}}}]^{y,}\ w_{is}
		\right]\\		
		0 & 0 & \frac{\partial w_{is}}{\partial x} & \left[\frac{\partial w_{is}}{\partial x}
		[-\mathbf{R}_{i}(\mathbf{\bar{p}}_s^{l,i})^{\text{\tiny{$\wedge$}}}]^{z,} + [-\mathbf{R}_{i}(r^0_{,x})^{\text{\tiny{$\wedge$}}}]^{z,}\ w_{is}
		\right]\\
		0 & 0 & \frac{\partial w_{is}}{\partial y} & \left[\frac{\partial w_{is}}{\partial y}
		[-\mathbf{R}_{i}(\mathbf{\bar{p}}_s^{l,i})^{\text{\tiny{$\wedge$}}}]^{z,} + [-\mathbf{R}_{i}(r^0_{,y})^{\text{\tiny{$\wedge$}}}]^{z,}\ w_{is}
		\right] \\
		0 & 0 & \frac{\partial w_{is}}{\partial z} & \left[\frac{\partial w_{is}}{\partial z}
		[-\mathbf{R}_{i}(\mathbf{\bar{p}}_s^{l,i})^{\text{\tiny{$\wedge$}}}]^{z,} + [-\mathbf{R}_{i}(r^0_{,z})^{\text{\tiny{$\wedge$}}}]^{z,}\ w_{is}
		\right]\\		
	\end{array} \right]
\end{split}
\end{equation}
\renewcommand\arraystretch{1}
avec $w_{is} = w_s(\mathbf{x}_i)$

\section{Matrice de Hooke}
\begin{equation*}
	C = \frac{E}{(1+\nu)(2-\nu)}
	\begin{array}{cccccc}
		×
	\end{array}

\end{equation}

\end{document}
